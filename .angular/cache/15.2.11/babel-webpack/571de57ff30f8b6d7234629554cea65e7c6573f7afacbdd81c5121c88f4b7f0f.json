{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../product.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../message.service\";\nimport * as i4 from \"@angular/common\";\nfunction ProductFormComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 16);\n  }\n}\nfunction ProductFormComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 16);\n  }\n}\nfunction ProductFormComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 16);\n  }\n}\nfunction ProductFormComponent_span_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.selectedFileName);\n  }\n}\nfunction ProductFormComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ProductFormComponent_div_24_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.removeImage());\n    });\n    i0.ɵɵtext(2, \"\\u2716\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"img\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r4.imagePreview, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ProductFormComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.isEditMode ? \"Product successfully edited.\" : \"Product successfully added.\", \" \");\n  }\n}\nexport class ProductFormComponent {\n  constructor(productService, fb, messageService) {\n    this.productService = productService;\n    this.fb = fb;\n    this.messageService = messageService;\n    this.product = null;\n    this.close = new EventEmitter();\n    this.formSubmitted = false;\n    this.isEditMode = false;\n    this.imagePreview = null;\n    this.imageBase64 = '';\n    this.selectedFileName = '';\n    this.productForm = this.fb.group({\n      name: ['', Validators.required],\n      price: ['', [Validators.required, Validators.min(0)]],\n      description: ['', Validators.required],\n      imageUrl: ['']\n    });\n  }\n  ngOnInit() {\n    if (this.product && this.product.id) {\n      this.isEditMode = true;\n      this.productForm.patchValue({\n        name: this.product.name,\n        price: this.product.price,\n        description: this.product.description,\n        imageUrl: this.product.imageUrl\n      });\n      this.imagePreview = this.product.imageUrl;\n    } else {\n      this.isEditMode = false;\n      this.productForm.reset();\n    }\n  }\n  generateRandomId() {\n    return Math.floor(10000 + Math.random() * 90000).toString();\n  }\n  onFileSelected(event) {\n    const file = event.target.files[0];\n    if (file) {\n      this.selectedFileName = file.name;\n      const reader = new FileReader();\n      reader.onload = e => {\n        this.imagePreview = e.target.result;\n        this.resizeImage(e.target.result);\n      };\n      reader.readAsDataURL(file);\n    } else {\n      this.selectedFileName = '';\n    }\n  }\n  resizeImage(base64Str) {\n    const img = new Image();\n    img.src = base64Str;\n    img.onload = () => {\n      const canvas = document.createElement(\"canvas\");\n      const ctx = canvas.getContext(\"2d\");\n      const maxWidth = 150;\n      const maxHeight = 150;\n      let width = img.width;\n      let height = img.height;\n      if (width > height) {\n        if (width > maxWidth) {\n          height *= maxWidth / width;\n          width = maxWidth;\n        }\n      } else {\n        if (height > maxHeight) {\n          width *= maxHeight / height;\n          height = maxHeight;\n        }\n      }\n      canvas.width = width;\n      canvas.height = height;\n      ctx?.drawImage(img, 0, 0, width, height);\n      this.imageBase64 = canvas.toDataURL(\"image/jpeg\", 0.7);\n    };\n  }\n  removeImage() {\n    this.imagePreview = null;\n    this.imageBase64 = '';\n    this.selectedFileName = '';\n    const fileInput = document.getElementById('image');\n    if (fileInput) {\n      fileInput.value = '';\n    }\n  }\n  onSubmit() {\n    if (this.productForm.valid) {\n      let product = this.productForm.value;\n      product.imageUrl = this.imageBase64;\n      if (!this.isEditMode) {\n        product.id = this.generateRandomId();\n      } else {\n        product.id = this.product.id;\n      }\n      if (this.isEditMode && this.product?.id) {\n        this.productService.updateProduct(product);\n        this.messageService.changeMessage('Product successfully edited');\n      } else {\n        this.productService.addProduct(product);\n        this.messageService.changeMessage('Product successfully added');\n      }\n      this.formSubmitted = true;\n      this.isEditMode = false;\n      this.productForm.reset();\n      this.imagePreview = null;\n      this.close.emit();\n    }\n  }\n  static {\n    this.ɵfac = function ProductFormComponent_Factory(t) {\n      return new (t || ProductFormComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.MessageService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProductFormComponent,\n      selectors: [[\"app-product-form\"]],\n      inputs: {\n        product: \"product\"\n      },\n      outputs: {\n        close: \"close\"\n      },\n      decls: 31,\n      vars: 10,\n      consts: [[1, \"product-form\", 3, \"formGroup\", \"ngSubmit\"], [\"for\", \"name\"], [\"id\", \"name\", \"formControlName\", \"name\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"for\", \"price\"], [\"id\", \"price\", \"formControlName\", \"price\", \"type\", \"number\"], [\"for\", \"description\"], [\"id\", \"description\", \"formControlName\", \"description\"], [\"for\", \"image\"], [1, \"custom-file-input\"], [\"type\", \"file\", \"id\", \"image\", \"accept\", \"image/*\", 3, \"change\"], [4, \"ngIf\"], [\"class\", \"image-preview-container\", 4, \"ngIf\"], [\"type\", \"submit\", 3, \"disabled\"], [\"type\", \"button\", 3, \"click\"], [\"class\", \"success-message\", 4, \"ngIf\"], [1, \"error-message\"], [1, \"image-preview-container\"], [\"type\", \"button\", 1, \"remove-image-btn\", 3, \"click\"], [1, \"thumbnail\", 3, \"src\"], [1, \"success-message\"]],\n      template: function ProductFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"form\", 0);\n          i0.ɵɵlistener(\"ngSubmit\", function ProductFormComponent_Template_form_ngSubmit_0_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵelementStart(1, \"h2\");\n          i0.ɵɵtext(2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\")(4, \"label\", 1);\n          i0.ɵɵtext(5, \"Product\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(6, \"input\", 2);\n          i0.ɵɵtemplate(7, ProductFormComponent_div_7_Template, 1, 0, \"div\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"div\")(9, \"label\", 4);\n          i0.ɵɵtext(10, \"Price\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(11, \"input\", 5);\n          i0.ɵɵtemplate(12, ProductFormComponent_div_12_Template, 1, 0, \"div\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"div\")(14, \"label\", 6);\n          i0.ɵɵtext(15, \"Description\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(16, \"textarea\", 7);\n          i0.ɵɵtemplate(17, ProductFormComponent_div_17_Template, 1, 0, \"div\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(18, \"div\")(19, \"label\", 8);\n          i0.ɵɵtext(20, \"Image\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"div\", 9)(22, \"input\", 10);\n          i0.ɵɵlistener(\"change\", function ProductFormComponent_Template_input_change_22_listener($event) {\n            return ctx.onFileSelected($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(23, ProductFormComponent_span_23_Template, 2, 1, \"span\", 11);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(24, ProductFormComponent_div_24_Template, 4, 1, \"div\", 12);\n          i0.ɵɵelement(25, \"br\");\n          i0.ɵɵelementStart(26, \"button\", 13);\n          i0.ɵɵtext(27);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"button\", 14);\n          i0.ɵɵlistener(\"click\", function ProductFormComponent_Template_button_click_28_listener() {\n            return ctx.close.emit();\n          });\n          i0.ɵɵtext(29, \"Cancel\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(30, ProductFormComponent_div_30_Template, 2, 1, \"div\", 15);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          let tmp_2_0;\n          let tmp_3_0;\n          let tmp_4_0;\n          i0.ɵɵproperty(\"formGroup\", ctx.productForm);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Edit product\" : \"Add product\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = ctx.productForm.get(\"name\")) == null ? null : tmp_2_0.invalid) && ((tmp_2_0 = ctx.productForm.get(\"name\")) == null ? null : tmp_2_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx.productForm.get(\"price\")) == null ? null : tmp_3_0.invalid) && ((tmp_3_0 = ctx.productForm.get(\"price\")) == null ? null : tmp_3_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_4_0 = ctx.productForm.get(\"description\")) == null ? null : tmp_4_0.invalid) && ((tmp_4_0 = ctx.productForm.get(\"description\")) == null ? null : tmp_4_0.touched));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedFileName);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.imagePreview);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.productForm.invalid);\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Save changess\" : \"Add product\", \" \");\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.formSubmitted);\n        }\n      },\n      dependencies: [i4.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NumberValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n      styles: [\".product-form[_ngcontent-%COMP%] {\\n  background-color: #fff;\\n  padding: 20px;\\n  border-radius: 8px;\\n  box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);\\n  max-width: 400px;  \\n  margin: 20px auto; \\n\\n}\\n\\ninput[type=\\\"number\\\"][_ngcontent-%COMP%]::-webkit-inner-spin-button {\\n  -webkit-appearance: none; \\n  margin: 0;\\n}\\n\\ninput.ng-invalid.ng-touched[_ngcontent-%COMP%], textarea.ng-invalid.ng-touched[_ngcontent-%COMP%] {\\n  border: 1px solid rgb(255, 108, 108);\\n\\n}\\n\\ninput[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 10px;\\n  margin-bottom: 15px;\\n  border: 1px solid #ccc;\\n  border-radius: 5px;\\n  box-sizing: border-box; \\n}\\n\\nbutton[_ngcontent-%COMP%] {\\n  width: 100%;\\n  padding: 12px;\\n  margin-bottom: 15px;\\n}\\n\\n.thumbnail[_ngcontent-%COMP%] {\\n  width: 100px;\\n  height: auto;\\n  display: block;\\n  margin-top: 10px;\\n  border: 1px solid #ddd;\\n  border-radius: 5px;\\n}\\n\\n\\n\\n\\n\\n.image-preview-container[_ngcontent-%COMP%] {\\n  position: relative;\\n  display: inline-block;\\n}\\n\\n.thumbnail[_ngcontent-%COMP%] {\\n  max-width: 150px;\\n  max-height: 150px;\\n  border-radius: 5px;\\n}\\n\\n.remove-image-btn[_ngcontent-%COMP%] {\\n  position: left;\\n  top: 2px;\\n  right: 2px;\\n  background: none;\\n  color: red;\\n  border: none;\\n  font-size: 18px;\\n  font-weight: bold;\\n  cursor: pointer;\\n  width: 22px;\\n  height: 22px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  transition: color 0.2s ease-in-out;\\n}\\n\\n.remove-image-btn[_ngcontent-%COMP%]:hover {\\n  color: darkred;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcHJvZHVjdC1mb3JtL3Byb2R1Y3QtZm9ybS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0Usc0JBQXNCO0VBQ3RCLGFBQWE7RUFDYixrQkFBa0I7RUFDbEIsMkNBQTJDO0VBQzNDLGdCQUFnQjtFQUNoQixpQkFBaUI7O0FBRW5COztBQUVBO0VBQ0Usd0JBQXdCO0VBQ3hCLFNBQVM7QUFDWDs7QUFFQTs7RUFFRSxvQ0FBb0M7O0FBRXRDOztBQUVBO0VBQ0UsV0FBVztFQUNYLGFBQWE7RUFDYixtQkFBbUI7RUFDbkIsc0JBQXNCO0VBQ3RCLGtCQUFrQjtFQUNsQixzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsYUFBYTtFQUNiLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFlBQVk7RUFDWixZQUFZO0VBQ1osY0FBYztFQUNkLGdCQUFnQjtFQUNoQixzQkFBc0I7RUFDdEIsa0JBQWtCO0FBQ3BCOzs7Ozs7QUFNQTtFQUNFLGtCQUFrQjtFQUNsQixxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxRQUFRO0VBQ1IsVUFBVTtFQUNWLGdCQUFnQjtFQUNoQixVQUFVO0VBQ1YsWUFBWTtFQUNaLGVBQWU7RUFDZixpQkFBaUI7RUFDakIsZUFBZTtFQUNmLFdBQVc7RUFDWCxZQUFZO0VBQ1osYUFBYTtFQUNiLG1CQUFtQjtFQUNuQix1QkFBdUI7RUFDdkIsa0NBQWtDO0FBQ3BDOztBQUVBO0VBQ0UsY0FBYztBQUNoQiIsInNvdXJjZXNDb250ZW50IjpbIi5wcm9kdWN0LWZvcm0ge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xuICBwYWRkaW5nOiAyMHB4O1xuICBib3JkZXItcmFkaXVzOiA4cHg7XG4gIGJveC1zaGFkb3c6IDBweCAycHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gIG1heC13aWR0aDogNDAwcHg7ICBcbiAgbWFyZ2luOiAyMHB4IGF1dG87IFxuXG59XG5cbmlucHV0W3R5cGU9XCJudW1iZXJcIl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24ge1xuICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7IFxuICBtYXJnaW46IDA7XG59XG5cbmlucHV0Lm5nLWludmFsaWQubmctdG91Y2hlZCwgXG50ZXh0YXJlYS5uZy1pbnZhbGlkLm5nLXRvdWNoZWQge1xuICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMjU1LCAxMDgsIDEwOCk7XG5cbn1cblxuaW5wdXQsIHRleHRhcmVhIHtcbiAgd2lkdGg6IDEwMCU7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIG1hcmdpbi1ib3R0b206IDE1cHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDsgXG59XG5cbmJ1dHRvbiB7XG4gIHdpZHRoOiAxMDAlO1xuICBwYWRkaW5nOiAxMnB4O1xuICBtYXJnaW4tYm90dG9tOiAxNXB4O1xufVxuXG4udGh1bWJuYWlsIHtcbiAgd2lkdGg6IDEwMHB4O1xuICBoZWlnaHQ6IGF1dG87XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBtYXJnaW4tdG9wOiAxMHB4O1xuICBib3JkZXI6IDFweCBzb2xpZCAjZGRkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG59XG5cblxuXG5cblxuLmltYWdlLXByZXZpZXctY29udGFpbmVyIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG59XG5cbi50aHVtYm5haWwge1xuICBtYXgtd2lkdGg6IDE1MHB4O1xuICBtYXgtaGVpZ2h0OiAxNTBweDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xufVxuXG4ucmVtb3ZlLWltYWdlLWJ0biB7XG4gIHBvc2l0aW9uOiBsZWZ0O1xuICB0b3A6IDJweDtcbiAgcmlnaHQ6IDJweDtcbiAgYmFja2dyb3VuZDogbm9uZTtcbiAgY29sb3I6IHJlZDtcbiAgYm9yZGVyOiBub25lO1xuICBmb250LXNpemU6IDE4cHg7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHdpZHRoOiAyMnB4O1xuICBoZWlnaHQ6IDIycHg7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2UtaW4tb3V0O1xufVxuXG4ucmVtb3ZlLWltYWdlLWJ0bjpob3ZlciB7XG4gIGNvbG9yOiBkYXJrcmVkO1xufVxuXG5cblxuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["EventEmitter","Validators","i0","ProductFormComponent","constructor","productService","fb","messageService","productForm","group","name","required","price","min","description","imageUrl","ngOnInit","product","id","isEditMode","patchValue","imagePreview","reset","generateRandomId","Math","floor","random","toString","onFileSelected","event","file","target","files","selectedFileName","reader","FileReader","onload","e","result","resizeImage","readAsDataURL","base64Str","img","Image","src","canvas","document","createElement","ctx","getContext","maxWidth","maxHeight","width","height","drawImage","imageBase64","toDataURL","removeImage","fileInput","getElementById","value","onSubmit","valid","updateProduct","changeMessage","addProduct","formSubmitted","close","emit","selectors","inputs","outputs","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/macbookair2020/Documents/PlanDeAprendizaje-main/src/app/product-form/product-form.component.ts","/Users/macbookair2020/Documents/PlanDeAprendizaje-main/src/app/product-form/product-form.component.html"],"sourcesContent":["import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ProductService } from '../product.service';\nimport { MessageService } from '../message.service';\n\n@Component({\n  selector: 'app-product-form',\n  templateUrl: './product-form.component.html',\n  styleUrls: ['./product-form.component.css']\n})\nexport class ProductFormComponent implements OnInit {\n  @Input() product: any = null;\n  @Output() close = new EventEmitter<void>();\n  productForm: FormGroup;\n  formSubmitted = false;\n  isEditMode: boolean = false;\n  imagePreview: string | ArrayBuffer | null = null; \n  imageBase64: string = ''; \n  selectedFileName = ''; \n\n\n \n  constructor(private productService: ProductService, private fb: FormBuilder, private messageService: MessageService) {\n    this.productForm = this.fb.group({\n      name: ['', Validators.required],\n      price: ['', [Validators.required, Validators.min(0)]],\n      description: ['', Validators.required],\n      imageUrl: [''] \n    \n    });\n  }\n\n  ngOnInit(): void {\n    if (this.product && this.product.id) {\n      this.isEditMode = true;\n      this.productForm.patchValue({\n        name: this.product.name,\n        price: this.product.price,\n        description: this.product.description,\n        imageUrl: this.product.imageUrl\n      });\n      this.imagePreview = this.product.imageUrl; \n    } else {\n      this.isEditMode = false;\n      this.productForm.reset();\n    }\n  }\n\n  generateRandomId(): string {\n    return Math.floor(10000 + Math.random() * 90000).toString();\n  }\n\n  onFileSelected(event: any) {\n    const file: File = event.target.files[0];\n    if (file) {\n      this.selectedFileName = file.name;\n      const reader = new FileReader();\n      reader.onload = (e: any) => {\n        this.imagePreview = e.target.result;\n        this.resizeImage(e.target.result);\n      };\n      reader.readAsDataURL(file);\n    } else {\n      this.selectedFileName = '';\n    }\n  }\n  \n  resizeImage(base64Str: string) {\n    const img = new Image();\n    img.src = base64Str;\n    img.onload = () => {\n      const canvas = document.createElement(\"canvas\");\n      const ctx = canvas.getContext(\"2d\");\n\n      const maxWidth = 150; \n      const maxHeight = 150;\n      let width = img.width;\n      let height = img.height;\n\n      if (width > height) {\n        if (width > maxWidth) {\n          height *= maxWidth / width;\n          width = maxWidth;\n        }\n      } else {\n        if (height > maxHeight) {\n          width *= maxHeight / height;\n          height = maxHeight;\n        }\n      }\n\n      canvas.width = width;\n      canvas.height = height;\n      ctx?.drawImage(img, 0, 0, width, height);\n\n      this.imageBase64 = canvas.toDataURL(\"image/jpeg\", 0.7);\n    };\n  }\n\n  removeImage() {\n    this.imagePreview = null;\n    this.imageBase64 = '';\n    this.selectedFileName = '';\n    const fileInput = document.getElementById('image') as HTMLInputElement;\n    if (fileInput) {\n      fileInput.value = '' \n    }\n } \n  \n  onSubmit(): void {\n    if (this.productForm.valid) {\n      let product = this.productForm.value;\n      product.imageUrl = this.imageBase64; \n\n      if (!this.isEditMode) {\n        product.id = this.generateRandomId();\n      } else {\n        product.id = this.product.id;\n      }\n\n      if (this.isEditMode && this.product?.id) {\n        this.productService.updateProduct(product);\n        this.messageService.changeMessage('Product successfully edited');\n      } else {\n        this.productService.addProduct(product);\n        this.messageService.changeMessage('Product successfully added');\n      }\n\n      this.formSubmitted = true;\n      this.isEditMode = false;\n      this.productForm.reset();\n      this.imagePreview = null; \n      this.close.emit();\n    }\n  }\n}\n","<form [formGroup]=\"productForm\" (ngSubmit)=\"onSubmit()\" class=\"product-form\">\n  <h2>{{ isEditMode ? 'Edit product' : 'Add product' }}</h2>\n\n  <div>\n    <label for=\"name\">Product</label>\n    <input id=\"name\" formControlName=\"name\" />\n    <div *ngIf=\"productForm.get('name')?.invalid && productForm.get('name')?.touched\" class=\"error-message\">\n    </div>\n  </div>\n\n  <div>\n    <label for=\"price\">Price</label>\n    <input id=\"price\" formControlName=\"price\" type=\"number\" />\n    <div *ngIf=\"productForm.get('price')?.invalid && productForm.get('price')?.touched\" class=\"error-message\">\n    </div>\n  </div>\n  \n  <div>\n    <label for=\"description\">Description</label>\n    <textarea id=\"description\" formControlName=\"description\"></textarea>\n    <div *ngIf=\"productForm.get('description')?.invalid && productForm.get('description')?.touched\" class=\"error-message\">\n  </div>\n  </div>\n\n  <div>\n    <label for=\"image\">Image</label>\n    <div class=\"custom-file-input\">\n      <input type=\"file\" id=\"image\" (change)=\"onFileSelected($event)\" accept=\"image/*\">\n      <span *ngIf=\"selectedFileName\">{{ selectedFileName }}</span>\n    </div>\n  </div>\n\n\n  <div class=\"image-preview-container\" *ngIf=\"imagePreview\">\n    <button type=\"button\" class=\"remove-image-btn\" (click)=\"removeImage()\">✖</button>\n    <img [src]=\"imagePreview\" class=\"thumbnail\">\n  </div>\n  \n<br>\n  <button [disabled]=\"productForm.invalid\" type=\"submit\">\n    {{ isEditMode ? 'Save changess' : 'Add product' }}\n  </button>\n  <button type=\"button\" (click)=\"close.emit()\">Cancel</button>\n  <div *ngIf=\"formSubmitted\" class=\"success-message\">\n    {{ isEditMode ? 'Product successfully edited.' : 'Product successfully added.' }}\n  </div>\n</form>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}